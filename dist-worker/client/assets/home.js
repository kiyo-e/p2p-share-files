import{r as v,j as e,u as i,a}from"./chunks/jsx-dev-runtime-1WYTjGlm.js";const E=w(),p=document.querySelector("main.container");p&&document.getElementById("homeView")&&v(e(I,{}),p);function I(){const[t,r]=i(!0),[n,d]=i(!1),[o,u]=i(""),[h,m]=i(3),g=a(c=>{const s=c.currentTarget;r(s.checked)},[]),b=a(c=>{const s=c.currentTarget;u(s.value)},[]),f=a(c=>{const s=c.currentTarget,l=Number.parseInt(s.value,10);Number.isFinite(l)&&m(Math.max(1,Math.min(10,l)))},[]),y=a(async()=>{if(!n){d(!0);try{const{roomId:c}=await T({maxConcurrent:h,creatorCid:E});if(t){const s=crypto.getRandomValues(new Uint8Array(32)),l=k(s);location.href=`/r/${c}#k=${l}`}else location.href=`/r/${c}`}finally{d(!1)}}},[n,t]),C=a(()=>{const c=o.trim().toUpperCase();c&&(location.href=`/r/${c}${location.hash||""}`)},[o]);return e("section",{id:"homeView",class:"card home",children:[e("div",{class:"homeGrid",children:[e("div",{class:"homeHero",children:[e("div",{class:"eyebrow",children:"DIRECT—PRIVATE—INSTANT"}),e("h1",{children:["ファイルを",e("br",{}),"直接送る"]}),e("p",{class:"lead",children:"サーバにアップロードせず、端末間で直接転送。接続の取り次ぎだけサーバを使います。"}),e("div",{class:"heroChips",children:[e("span",{class:"chip",children:"NO SERVER STORAGE"}),e("span",{class:"chip",children:"1:N P2P"}),e("span",{class:"chip",children:"WEBRTC"})]}),e("div",{class:"steps",children:[e("div",{class:"step",children:[e("span",{children:"1"})," ルーム作成"]}),e("div",{class:"step",children:[e("span",{children:"2"})," リンク共有"]}),e("div",{class:"step",children:[e("span",{children:"3"})," 送信"]})]})]}),e("div",{class:"homePanel",children:[e("div",{class:"panelBlock",children:[e("div",{class:"panelTitle",children:"送信を開始"}),e("label",{class:"toggle",children:[e("input",{id:"encryptToggle",type:"checkbox",checked:t,disabled:n,onInput:g}),e("span",{children:"E2E暗号化ON"})]}),e("label",{class:"row gap",children:[e("span",{class:"muted small",children:"同時送信上限"}),e("input",{id:"maxConcurrent",class:"input",type:"number",min:"1",max:"10",value:String(h),disabled:n,onInput:f})]}),e("button",{id:"createBtn",class:"btn primary",disabled:n,onClick:y,children:"ルーム作成"})]}),e("hr",{class:"sep"}),e("div",{class:"panelBlock",children:[e("div",{class:"panelTitle",children:"受信に参加"}),e("div",{class:"row gap wrap",children:[e("input",{id:"joinCode",class:"input",placeholder:"コード入力（例: ABCD...）",value:o,disabled:n,onInput:b}),e("button",{id:"joinBtn",class:"btn",disabled:n,onClick:C,children:"参加"})]}),e("p",{class:"muted small",children:"暗号化ONならリンクに鍵が含まれます。"})]})]})]}),e("div",{class:"foot muted",children:"P2Pのみ。ネットワーク条件によっては接続不可（TURN無し）"})]})}async function T(t){const r=await fetch("/api/rooms",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error("ルーム作成に失敗しました");return r.json()}function k(t){let r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}function w(){const t="share-files-client-id",r=localStorage.getItem(t);if(r)return r;const n=crypto.randomUUID();return localStorage.setItem(t,n),n}
//# sourceMappingURL=home.js.map
